function cov_16l3b291aj(){var path="C:\\Users\\loco8\\workspace\\eurofirms-bootcamp-202305\\staff\\manuel-david-castillo\\instaflan-fullstack\\api\\logic\\post-logic\\retrieveFavPosts.js";var hash="7c2880b488b1c313d0915749a05a169fa045a400";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\loco8\\workspace\\eurofirms-bootcamp-202305\\staff\\manuel-david-castillo\\instaflan-fullstack\\api\\logic\\post-logic\\retrieveFavPosts.js",statementMap:{"0":{start:{line:1,column:21},end:{line:1,column:49}},"1":{start:{line:2,column:21},end:{line:2,column:53}},"2":{start:{line:5,column:4},end:{line:5,column:22}},"3":{start:{line:6,column:4},end:{line:6,column:29}},"4":{start:{line:8,column:4},end:{line:47,column:2}},"5":{start:{line:10,column:8},end:{line:10,column:52}},"6":{start:{line:10,column:19},end:{line:10,column:52}},"7":{start:{line:11,column:8},end:{line:11,column:59}},"8":{start:{line:11,column:26},end:{line:11,column:59}},"9":{start:{line:13,column:25},end:{line:13,column:45}},"10":{start:{line:15,column:8},end:{line:18,column:34}},"11":{start:{line:21,column:8},end:{line:44,column:10}},"12":{start:{line:22,column:12},end:{line:22,column:41}},"13":{start:{line:23,column:12},end:{line:23,column:27}},"14":{start:{line:25,column:12},end:{line:29,column:13}},"15":{start:{line:26,column:12},end:{line:26,column:55}},"16":{start:{line:28,column:12},end:{line:28,column:34}},"17":{start:{line:31,column:11},end:{line:31,column:26}},"18":{start:{line:33,column:11},end:{line:43,column:12}},"19":{start:{line:34,column:12},end:{line:42,column:13}},"20":{start:{line:35,column:12},end:{line:35,column:47}},"21":{start:{line:36,column:12},end:{line:36,column:30}},"22":{start:{line:38,column:12},end:{line:41,column:13}},"23":{start:{line:39,column:16},end:{line:39,column:54}},"24":{start:{line:40,column:16},end:{line:40,column:41}},"25":{start:{line:46,column:8},end:{line:46,column:20}},"26":{start:{line:49,column:0},end:{line:49,column:33}}},fnMap:{"0":{name:"retrieveFavPosts",decl:{start:{line:4,column:9},end:{line:4,column:25}},loc:{start:{line:4,column:49},end:{line:47,column:3}},line:4},"1":{name:"(anonymous_1)",decl:{start:{line:9,column:10},end:{line:9,column:11}},loc:{start:{line:9,column:35},end:{line:19,column:5}},line:9},"2":{name:"(anonymous_2)",decl:{start:{line:20,column:10},end:{line:20,column:11}},loc:{start:{line:20,column:19},end:{line:47,column:1}},line:20},"3":{name:"(anonymous_3)",decl:{start:{line:21,column:22},end:{line:21,column:23}},loc:{start:{line:21,column:30},end:{line:44,column:9}},line:21},"4":{name:"(anonymous_4)",decl:{start:{line:34,column:34},end:{line:34,column:35}},loc:{start:{line:34,column:45},end:{line:42,column:12}},line:34}},branchMap:{"0":{loc:{start:{line:10,column:8},end:{line:10,column:52}},type:"if",locations:[{start:{line:10,column:8},end:{line:10,column:52}},{start:{line:10,column:8},end:{line:10,column:52}}],line:10},"1":{loc:{start:{line:11,column:8},end:{line:11,column:59}},type:"if",locations:[{start:{line:11,column:8},end:{line:11,column:59}},{start:{line:11,column:8},end:{line:11,column:59}}],line:11},"2":{loc:{start:{line:25,column:12},end:{line:29,column:13}},type:"if",locations:[{start:{line:25,column:12},end:{line:29,column:13}},{start:{line:25,column:12},end:{line:29,column:13}}],line:25},"3":{loc:{start:{line:33,column:11},end:{line:43,column:12}},type:"if",locations:[{start:{line:33,column:11},end:{line:43,column:12}},{start:{line:33,column:11},end:{line:43,column:12}}],line:33},"4":{loc:{start:{line:38,column:12},end:{line:41,column:13}},type:"if",locations:[{start:{line:38,column:12},end:{line:41,column:13}},{start:{line:38,column:12},end:{line:41,column:13}}],line:38}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"7c2880b488b1c313d0915749a05a169fa045a400"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_16l3b291aj=function(){return actualCoverage;};}return actualCoverage;}cov_16l3b291aj();const{User,Post}=(cov_16l3b291aj().s[0]++,require('../../data/models'));const{validateId}=(cov_16l3b291aj().s[1]++,require('../helpers/validators'));function retrieveFavPosts(userId,userIdProfile){cov_16l3b291aj().f[0]++;cov_16l3b291aj().s[2]++;validateId(userId);cov_16l3b291aj().s[3]++;validateId(userIdProfile);cov_16l3b291aj().s[4]++;return Promise.all([User.findById(userId).lean(),User.findById(userIdProfile).lean()]).then(([user,userProfile])=>{cov_16l3b291aj().f[1]++;cov_16l3b291aj().s[5]++;if(!user){cov_16l3b291aj().b[0][0]++;cov_16l3b291aj().s[6]++;throw new Error('user not found');}else{cov_16l3b291aj().b[0][1]++;}cov_16l3b291aj().s[7]++;if(!userProfile){cov_16l3b291aj().b[1][0]++;cov_16l3b291aj().s[8]++;throw new Error('user not found');}else{cov_16l3b291aj().b[1][1]++;}const favPosts=(cov_16l3b291aj().s[9]++,userProfile.favPosts);cov_16l3b291aj().s[10]++;return Post.find({_id:favPosts},'-__v').populate('author','name image').populate({path:'comments.author',select:'name image'}).sort({date:-1}).lean();}).then(posts=>{cov_16l3b291aj().f[2]++;cov_16l3b291aj().s[11]++;posts.forEach(post=>{cov_16l3b291aj().f[3]++;cov_16l3b291aj().s[12]++;post.id=post._id.toString();cov_16l3b291aj().s[13]++;delete post._id;cov_16l3b291aj().s[14]++;if(post.author._id){cov_16l3b291aj().b[2][0]++;cov_16l3b291aj().s[15]++;post.author.id=post.author._id.toString();cov_16l3b291aj().s[16]++;delete post.author._id;}else{cov_16l3b291aj().b[2][1]++;}cov_16l3b291aj().s[17]++;post.fav=true;cov_16l3b291aj().s[18]++;if(post.comments){cov_16l3b291aj().b[3][0]++;cov_16l3b291aj().s[19]++;post.comments.forEach(comment=>{cov_16l3b291aj().f[4]++;cov_16l3b291aj().s[20]++;comment.id=comment._id.toString();cov_16l3b291aj().s[21]++;delete comment._id;cov_16l3b291aj().s[22]++;if(comment.author._id){cov_16l3b291aj().b[4][0]++;cov_16l3b291aj().s[23]++;comment.author.id=comment.author._id;cov_16l3b291aj().s[24]++;delete comment.author._id;}else{cov_16l3b291aj().b[4][1]++;}});}else{cov_16l3b291aj().b[3][1]++;}});cov_16l3b291aj().s[25]++;return posts;});}cov_16l3b291aj().s[26]++;module.exports=retrieveFavPosts;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMTZsM2IyOTFhaiIsImFjdHVhbENvdmVyYWdlIiwiVXNlciIsIlBvc3QiLCJzIiwicmVxdWlyZSIsInZhbGlkYXRlSWQiLCJyZXRyaWV2ZUZhdlBvc3RzIiwidXNlcklkIiwidXNlcklkUHJvZmlsZSIsImYiLCJQcm9taXNlIiwiYWxsIiwiZmluZEJ5SWQiLCJsZWFuIiwidGhlbiIsInVzZXIiLCJ1c2VyUHJvZmlsZSIsImIiLCJFcnJvciIsImZhdlBvc3RzIiwiZmluZCIsIl9pZCIsInBvcHVsYXRlIiwicGF0aCIsInNlbGVjdCIsInNvcnQiLCJkYXRlIiwicG9zdHMiLCJmb3JFYWNoIiwicG9zdCIsImlkIiwidG9TdHJpbmciLCJhdXRob3IiLCJmYXYiLCJjb21tZW50cyIsImNvbW1lbnQiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsicmV0cmlldmVGYXZQb3N0cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7VXNlciwgUG9zdH0gPSByZXF1aXJlKCcuLi8uLi9kYXRhL21vZGVscycpXHJcbmNvbnN0IHt2YWxpZGF0ZUlkfSA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvdmFsaWRhdG9ycycpXHJcblxyXG5mdW5jdGlvbiByZXRyaWV2ZUZhdlBvc3RzKHVzZXJJZCwgdXNlcklkUHJvZmlsZSkge1xyXG4gICAgdmFsaWRhdGVJZCh1c2VySWQpXHJcbiAgICB2YWxpZGF0ZUlkKHVzZXJJZFByb2ZpbGUpXHJcblxyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFtVc2VyLmZpbmRCeUlkKHVzZXJJZCkubGVhbigpLCBVc2VyLmZpbmRCeUlkKHVzZXJJZFByb2ZpbGUpLmxlYW4oKV0pXHJcbiAgICAudGhlbigoW3VzZXIsIHVzZXJQcm9maWxlXSkgPT4ge1xyXG4gICAgICAgIGlmICghdXNlcikgdGhyb3cgbmV3IEVycm9yKCd1c2VyIG5vdCBmb3VuZCcpXHJcbiAgICAgICAgaWYgKCF1c2VyUHJvZmlsZSkgdGhyb3cgbmV3IEVycm9yKCd1c2VyIG5vdCBmb3VuZCcpXHJcblxyXG4gICAgICAgIGNvbnN0IGZhdlBvc3RzID0gdXNlclByb2ZpbGUuZmF2UG9zdHNcclxuXHJcbiAgICAgICAgcmV0dXJuICBQb3N0LmZpbmQoe19pZDogZmF2UG9zdHN9LCAnLV9fdicpXHJcbiAgICAgICAgLnBvcHVsYXRlKCdhdXRob3InLCAnbmFtZSBpbWFnZScpXHJcbiAgICAgICAgLnBvcHVsYXRlKHtwYXRoOiAnY29tbWVudHMuYXV0aG9yJywgc2VsZWN0OiAnbmFtZSBpbWFnZSd9KVxyXG4gICAgICAgIC5zb3J0KHsgZGF0ZTogLTEgfSkubGVhbigpXHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKHBvc3RzKT0+e1xyXG4gICAgICAgIHBvc3RzLmZvckVhY2gocG9zdCA9PiB7XHJcbiAgICAgICAgICAgIHBvc3QuaWQgPSBwb3N0Ll9pZC50b1N0cmluZygpXHJcbiAgICAgICAgICAgIGRlbGV0ZSBwb3N0Ll9pZFxyXG5cclxuICAgICAgICAgICAgaWYocG9zdC5hdXRob3IuX2lkKXtcclxuICAgICAgICAgICAgcG9zdC5hdXRob3IuaWQgPSBwb3N0LmF1dGhvci5faWQudG9TdHJpbmcoKVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZGVsZXRlIHBvc3QuYXV0aG9yLl9pZFxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgIHBvc3QuZmF2ID0gdHJ1ZVxyXG5cclxuICAgICAgICAgICBpZihwb3N0LmNvbW1lbnRzKSB7XHJcbiAgICAgICAgICAgIHBvc3QuY29tbWVudHMuZm9yRWFjaChjb21tZW50ID0+IHtcclxuICAgICAgICAgICAgY29tbWVudC5pZCA9IGNvbW1lbnQuX2lkLnRvU3RyaW5nKClcclxuICAgICAgICAgICAgZGVsZXRlIGNvbW1lbnQuX2lkXHJcblxyXG4gICAgICAgICAgICBpZihjb21tZW50LmF1dGhvci5faWQpIHtcclxuICAgICAgICAgICAgICAgIGNvbW1lbnQuYXV0aG9yLmlkID0gY29tbWVudC5hdXRob3IuX2lkXHJcbiAgICAgICAgICAgICAgICBkZWxldGUgY29tbWVudC5hdXRob3IuX2lkXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICB9KVxyXG4gICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG5cclxuICAgICAgICByZXR1cm4gcG9zdHNcclxufSl9XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHJldHJpZXZlRmF2UG9zdHMiXSwibWFwcGluZ3MiOiJ1cUlBZVk7QUFBQUEsY0FBQSxTQUFBQSxDQUFBLFNBQUFDLGNBQUEsV0FBQUEsY0FBQSxFQUFBRCxjQUFBLEdBZlosS0FBTSxDQUFDRSxJQUFJLENBQUVDLElBQUksQ0FBQyxFQUFBSCxjQUFBLEdBQUFJLENBQUEsTUFBR0MsT0FBTyxDQUFDLG1CQUFtQixDQUFDLEVBQ2pELEtBQU0sQ0FBQ0MsVUFBVSxDQUFDLEVBQUFOLGNBQUEsR0FBQUksQ0FBQSxNQUFHQyxPQUFPLENBQUMsdUJBQXVCLENBQUMsRUFFckQsUUFBUyxDQUFBRSxnQkFBZ0JBLENBQUNDLE1BQU0sQ0FBRUMsYUFBYSxDQUFFLENBQUFULGNBQUEsR0FBQVUsQ0FBQSxNQUFBVixjQUFBLEdBQUFJLENBQUEsTUFDN0NFLFVBQVUsQ0FBQ0UsTUFBTSxDQUFDLENBQUFSLGNBQUEsR0FBQUksQ0FBQSxNQUNsQkUsVUFBVSxDQUFDRyxhQUFhLENBQUMsQ0FBQVQsY0FBQSxHQUFBSSxDQUFBLE1BRXpCLE1BQU8sQ0FBQU8sT0FBTyxDQUFDQyxHQUFHLENBQUMsQ0FBQ1YsSUFBSSxDQUFDVyxRQUFRLENBQUNMLE1BQU0sQ0FBQyxDQUFDTSxJQUFJLENBQUMsQ0FBQyxDQUFFWixJQUFJLENBQUNXLFFBQVEsQ0FBQ0osYUFBYSxDQUFDLENBQUNLLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUN0RkMsSUFBSSxDQUFDLENBQUMsQ0FBQ0MsSUFBSSxDQUFFQyxXQUFXLENBQUMsR0FBSyxDQUFBakIsY0FBQSxHQUFBVSxDQUFBLE1BQUFWLGNBQUEsR0FBQUksQ0FBQSxNQUMzQixHQUFJ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