function cov_16l3b291aj(){var path="C:\\Users\\loco8\\workspace\\eurofirms-bootcamp-202305\\staff\\manuel-david-castillo\\instaflan-fullstack\\api\\logic\\post-logic\\retrieveFavPosts.js";var hash="9515b94f7a3b7d22c0b38d5a652f360a38c2326f";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\loco8\\workspace\\eurofirms-bootcamp-202305\\staff\\manuel-david-castillo\\instaflan-fullstack\\api\\logic\\post-logic\\retrieveFavPosts.js",statementMap:{"0":{start:{line:1,column:23},end:{line:1,column:51}},"1":{start:{line:2,column:23},end:{line:2,column:55}},"2":{start:{line:5,column:4},end:{line:5,column:22}},"3":{start:{line:6,column:4},end:{line:6,column:29}},"4":{start:{line:8,column:4},end:{line:44,column:10}},"5":{start:{line:10,column:12},end:{line:10,column:56}},"6":{start:{line:10,column:23},end:{line:10,column:56}},"7":{start:{line:11,column:12},end:{line:11,column:63}},"8":{start:{line:11,column:30},end:{line:11,column:63}},"9":{start:{line:13,column:29},end:{line:13,column:49}},"10":{start:{line:15,column:12},end:{line:18,column:42}},"11":{start:{line:21,column:12},end:{line:41,column:14}},"12":{start:{line:22,column:16},end:{line:22,column:45}},"13":{start:{line:23,column:16},end:{line:23,column:31}},"14":{start:{line:25,column:16},end:{line:28,column:17}},"15":{start:{line:26,column:20},end:{line:26,column:63}},"16":{start:{line:27,column:20},end:{line:27,column:42}},"17":{start:{line:30,column:16},end:{line:30,column:31}},"18":{start:{line:32,column:16},end:{line:40,column:18}},"19":{start:{line:33,column:20},end:{line:33,column:55}},"20":{start:{line:34,column:20},end:{line:34,column:38}},"21":{start:{line:36,column:20},end:{line:39,column:21}},"22":{start:{line:37,column:24},end:{line:37,column:62}},"23":{start:{line:38,column:24},end:{line:38,column:49}},"24":{start:{line:43,column:12},end:{line:43,column:24}},"25":{start:{line:47,column:0},end:{line:47,column:33}}},fnMap:{"0":{name:"retrieveFavPosts",decl:{start:{line:4,column:9},end:{line:4,column:25}},loc:{start:{line:4,column:49},end:{line:45,column:1}},line:4},"1":{name:"(anonymous_1)",decl:{start:{line:9,column:14},end:{line:9,column:15}},loc:{start:{line:9,column:39},end:{line:19,column:9}},line:9},"2":{name:"(anonymous_2)",decl:{start:{line:20,column:14},end:{line:20,column:15}},loc:{start:{line:20,column:25},end:{line:44,column:9}},line:20},"3":{name:"(anonymous_3)",decl:{start:{line:21,column:26},end:{line:21,column:27}},loc:{start:{line:21,column:34},end:{line:41,column:13}},line:21},"4":{name:"(anonymous_4)",decl:{start:{line:32,column:38},end:{line:32,column:39}},loc:{start:{line:32,column:49},end:{line:40,column:17}},line:32}},branchMap:{"0":{loc:{start:{line:10,column:12},end:{line:10,column:56}},type:"if",locations:[{start:{line:10,column:12},end:{line:10,column:56}},{start:{line:10,column:12},end:{line:10,column:56}}],line:10},"1":{loc:{start:{line:11,column:12},end:{line:11,column:63}},type:"if",locations:[{start:{line:11,column:12},end:{line:11,column:63}},{start:{line:11,column:12},end:{line:11,column:63}}],line:11},"2":{loc:{start:{line:25,column:16},end:{line:28,column:17}},type:"if",locations:[{start:{line:25,column:16},end:{line:28,column:17}},{start:{line:25,column:16},end:{line:28,column:17}}],line:25},"3":{loc:{start:{line:36,column:20},end:{line:39,column:21}},type:"if",locations:[{start:{line:36,column:20},end:{line:39,column:21}},{start:{line:36,column:20},end:{line:39,column:21}}],line:36}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"9515b94f7a3b7d22c0b38d5a652f360a38c2326f"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_16l3b291aj=function(){return actualCoverage;};}return actualCoverage;}cov_16l3b291aj();const{User,Post}=(cov_16l3b291aj().s[0]++,require('../../data/models'));const{validateId}=(cov_16l3b291aj().s[1]++,require('../helpers/validators'));function retrieveFavPosts(userId,userIdProfile){cov_16l3b291aj().f[0]++;cov_16l3b291aj().s[2]++;validateId(userId);cov_16l3b291aj().s[3]++;validateId(userIdProfile);cov_16l3b291aj().s[4]++;return Promise.all([User.findById(userId).lean(),User.findById(userIdProfile).lean()]).then(([user,userProfile])=>{cov_16l3b291aj().f[1]++;cov_16l3b291aj().s[5]++;if(!user){cov_16l3b291aj().b[0][0]++;cov_16l3b291aj().s[6]++;throw new Error('user not found');}else{cov_16l3b291aj().b[0][1]++;}cov_16l3b291aj().s[7]++;if(!userProfile){cov_16l3b291aj().b[1][0]++;cov_16l3b291aj().s[8]++;throw new Error('user not found');}else{cov_16l3b291aj().b[1][1]++;}const favPosts=(cov_16l3b291aj().s[9]++,userProfile.favPosts);cov_16l3b291aj().s[10]++;return Post.find({_id:favPosts},'-__v').populate('author','name image').populate({path:'comments.author',select:'name image'}).sort({date:-1}).lean();}).then(posts=>{cov_16l3b291aj().f[2]++;cov_16l3b291aj().s[11]++;posts.forEach(post=>{cov_16l3b291aj().f[3]++;cov_16l3b291aj().s[12]++;post.id=post._id.toString();cov_16l3b291aj().s[13]++;delete post._id;cov_16l3b291aj().s[14]++;if(post.author._id){cov_16l3b291aj().b[2][0]++;cov_16l3b291aj().s[15]++;post.author.id=post.author._id.toString();cov_16l3b291aj().s[16]++;delete post.author._id;}else{cov_16l3b291aj().b[2][1]++;}cov_16l3b291aj().s[17]++;post.fav=true;cov_16l3b291aj().s[18]++;post.comments.forEach(comment=>{cov_16l3b291aj().f[4]++;cov_16l3b291aj().s[19]++;comment.id=comment._id.toString();cov_16l3b291aj().s[20]++;delete comment._id;cov_16l3b291aj().s[21]++;if(comment.author._id){cov_16l3b291aj().b[3][0]++;cov_16l3b291aj().s[22]++;comment.author.id=comment.author._id;cov_16l3b291aj().s[23]++;delete comment.author._id;}else{cov_16l3b291aj().b[3][1]++;}});});cov_16l3b291aj().s[24]++;return posts;});}cov_16l3b291aj().s[25]++;module.exports=retrieveFavPosts;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMTZsM2IyOTFhaiIsImFjdHVhbENvdmVyYWdlIiwiVXNlciIsIlBvc3QiLCJzIiwicmVxdWlyZSIsInZhbGlkYXRlSWQiLCJyZXRyaWV2ZUZhdlBvc3RzIiwidXNlcklkIiwidXNlcklkUHJvZmlsZSIsImYiLCJQcm9taXNlIiwiYWxsIiwiZmluZEJ5SWQiLCJsZWFuIiwidGhlbiIsInVzZXIiLCJ1c2VyUHJvZmlsZSIsImIiLCJFcnJvciIsImZhdlBvc3RzIiwiZmluZCIsIl9pZCIsInBvcHVsYXRlIiwicGF0aCIsInNlbGVjdCIsInNvcnQiLCJkYXRlIiwicG9zdHMiLCJmb3JFYWNoIiwicG9zdCIsImlkIiwidG9TdHJpbmciLCJhdXRob3IiLCJmYXYiLCJjb21tZW50cyIsImNvbW1lbnQiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsicmV0cmlldmVGYXZQb3N0cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IFVzZXIsIFBvc3QgfSA9IHJlcXVpcmUoJy4uLy4uL2RhdGEvbW9kZWxzJylcclxuY29uc3QgeyB2YWxpZGF0ZUlkIH0gPSByZXF1aXJlKCcuLi9oZWxwZXJzL3ZhbGlkYXRvcnMnKVxyXG5cclxuZnVuY3Rpb24gcmV0cmlldmVGYXZQb3N0cyh1c2VySWQsIHVzZXJJZFByb2ZpbGUpIHtcclxuICAgIHZhbGlkYXRlSWQodXNlcklkKVxyXG4gICAgdmFsaWRhdGVJZCh1c2VySWRQcm9maWxlKVxyXG5cclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbVXNlci5maW5kQnlJZCh1c2VySWQpLmxlYW4oKSwgVXNlci5maW5kQnlJZCh1c2VySWRQcm9maWxlKS5sZWFuKCldKVxyXG4gICAgICAgIC50aGVuKChbdXNlciwgdXNlclByb2ZpbGVdKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghdXNlcikgdGhyb3cgbmV3IEVycm9yKCd1c2VyIG5vdCBmb3VuZCcpXHJcbiAgICAgICAgICAgIGlmICghdXNlclByb2ZpbGUpIHRocm93IG5ldyBFcnJvcigndXNlciBub3QgZm91bmQnKVxyXG5cclxuICAgICAgICAgICAgY29uc3QgZmF2UG9zdHMgPSB1c2VyUHJvZmlsZS5mYXZQb3N0c1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIFBvc3QuZmluZCh7IF9pZDogZmF2UG9zdHMgfSwgJy1fX3YnKVxyXG4gICAgICAgICAgICAgICAgLnBvcHVsYXRlKCdhdXRob3InLCAnbmFtZSBpbWFnZScpXHJcbiAgICAgICAgICAgICAgICAucG9wdWxhdGUoeyBwYXRoOiAnY29tbWVudHMuYXV0aG9yJywgc2VsZWN0OiAnbmFtZSBpbWFnZScgfSlcclxuICAgICAgICAgICAgICAgIC5zb3J0KHsgZGF0ZTogLTEgfSkubGVhbigpXHJcbiAgICAgICAgfSlcclxuICAgICAgICAudGhlbigocG9zdHMpID0+IHtcclxuICAgICAgICAgICAgcG9zdHMuZm9yRWFjaChwb3N0ID0+IHtcclxuICAgICAgICAgICAgICAgIHBvc3QuaWQgPSBwb3N0Ll9pZC50b1N0cmluZygpXHJcbiAgICAgICAgICAgICAgICBkZWxldGUgcG9zdC5faWRcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAocG9zdC5hdXRob3IuX2lkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcG9zdC5hdXRob3IuaWQgPSBwb3N0LmF1dGhvci5faWQudG9TdHJpbmcoKVxyXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBwb3N0LmF1dGhvci5faWRcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBwb3N0LmZhdiA9IHRydWVcclxuXHJcbiAgICAgICAgICAgICAgICBwb3N0LmNvbW1lbnRzLmZvckVhY2goY29tbWVudCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29tbWVudC5pZCA9IGNvbW1lbnQuX2lkLnRvU3RyaW5nKClcclxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgY29tbWVudC5faWRcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbW1lbnQuYXV0aG9yLl9pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tZW50LmF1dGhvci5pZCA9IGNvbW1lbnQuYXV0aG9yLl9pZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgY29tbWVudC5hdXRob3IuX2lkXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBwb3N0c1xyXG4gICAgICAgIH0pXHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcmV0cmlldmVGYXZQb3N0cyJdLCJtYXBwaW5ncyI6InM2SEFlWTtBQUFBQSxjQUFBLFNBQUFBLENBQUEsU0FBQUMsY0FBQSxXQUFBQSxjQUFBLEVBQUFELGNBQUEsR0FmWixLQUFNLENBQUVFLElBQUksQ0FBRUMsSUFBSyxDQUFDLEVBQUFILGNBQUEsR0FBQUksQ0FBQSxNQUFHQyxPQUFPLENBQUMsbUJBQW1CLENBQUMsRUFDbkQsS0FBTSxDQUFFQyxVQUFXLENBQUMsRUFBQU4sY0FBQSxHQUFBSSxDQUFBLE1BQUdDLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQyxFQUV2RCxRQUFTLENBQUFFLGdCQUFnQkEsQ0FBQ0MsTUFBTSxDQUFFQyxhQUFhLENBQUUsQ0FBQVQsY0FBQSxHQUFBVSxDQUFBLE1BQUFWLGNBQUEsR0FBQUksQ0FBQSxNQUM3Q0UsVUFBVSxDQUFDRSxNQUFNLENBQUMsQ0FBQVIsY0FBQSxHQUFBSSxDQUFBLE1BQ2xCRSxVQUFVLENBQUNHLGFBQWEsQ0FBQyxDQUFBVCxjQUFBLEdBQUFJLENBQUEsTUFFekIsTUFBTyxDQUFBTyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxDQUFDVixJQUFJLENBQUNXLFFBQVEsQ0FBQ0wsTUFBTSxDQUFDLENBQUNNLElBQUksQ0FBQyxDQUFDLENBQUVaLElBQUksQ0FBQ1csUUFBUSxDQUFDSixhQUFhLENBQUMsQ0FBQ0ssSUFBSSxDQUFDLENBQUMsQ0FB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