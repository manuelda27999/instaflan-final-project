function cov_sgojlti7r(){var path="C:\\Users\\loco8\\workspace\\eurofirms-bootcamp-202305\\staff\\manuel-david-castillo\\instaflan-fullstack\\api\\logic\\post-logic\\editPost.js";var hash="bc0a01199c8be98771e062508253d1ad475e11ea";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\loco8\\workspace\\eurofirms-bootcamp-202305\\staff\\manuel-david-castillo\\instaflan-fullstack\\api\\logic\\post-logic\\editPost.js",statementMap:{"0":{start:{line:1,column:23},end:{line:1,column:51}},"1":{start:{line:2,column:52},end:{line:2,column:84}},"2":{start:{line:5,column:4},end:{line:5,column:22}},"3":{start:{line:6,column:4},end:{line:6,column:22}},"4":{start:{line:7,column:4},end:{line:7,column:24}},"5":{start:{line:8,column:4},end:{line:8,column:22}},"6":{start:{line:10,column:4},end:{line:22,column:24}},"7":{start:{line:12,column:12},end:{line:12,column:56}},"8":{start:{line:12,column:23},end:{line:12,column:56}},"9":{start:{line:13,column:12},end:{line:13,column:56}},"10":{start:{line:13,column:23},end:{line:13,column:56}},"11":{start:{line:15,column:12},end:{line:15,column:106}},"12":{start:{line:15,column:51},end:{line:15,column:106}},"13":{start:{line:17,column:12},end:{line:17,column:30}},"14":{start:{line:18,column:12},end:{line:18,column:28}},"15":{start:{line:20,column:12},end:{line:20,column:30}},"16":{start:{line:25,column:0},end:{line:25,column:25}}},fnMap:{"0":{name:"editPost",decl:{start:{line:4,column:9},end:{line:4,column:17}},loc:{start:{line:4,column:47},end:{line:23,column:1}},line:4},"1":{name:"(anonymous_1)",decl:{start:{line:11,column:14},end:{line:11,column:15}},loc:{start:{line:11,column:32},end:{line:21,column:9}},line:11},"2":{name:"(anonymous_2)",decl:{start:{line:22,column:14},end:{line:22,column:15}},loc:{start:{line:22,column:20},end:{line:22,column:23}},line:22}},branchMap:{"0":{loc:{start:{line:12,column:12},end:{line:12,column:56}},type:"if",locations:[{start:{line:12,column:12},end:{line:12,column:56}},{start:{line:12,column:12},end:{line:12,column:56}}],line:12},"1":{loc:{start:{line:13,column:12},end:{line:13,column:56}},type:"if",locations:[{start:{line:13,column:12},end:{line:13,column:56}},{start:{line:13,column:12},end:{line:13,column:56}}],line:13},"2":{loc:{start:{line:15,column:12},end:{line:15,column:106}},type:"if",locations:[{start:{line:15,column:12},end:{line:15,column:106}},{start:{line:15,column:12},end:{line:15,column:106}}],line:15}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"bc0a01199c8be98771e062508253d1ad475e11ea"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_sgojlti7r=function(){return actualCoverage;};}return actualCoverage;}cov_sgojlti7r();const{User,Post}=(cov_sgojlti7r().s[0]++,require('../../data/models'));const{validateId,validateImage,validateText}=(cov_sgojlti7r().s[1]++,require('../helpers/validators'));function editPost(userId,postId,image,text){cov_sgojlti7r().f[0]++;cov_sgojlti7r().s[2]++;validateId(userId);cov_sgojlti7r().s[3]++;validateId(postId);cov_sgojlti7r().s[4]++;validateImage(image);cov_sgojlti7r().s[5]++;validateText(text);cov_sgojlti7r().s[6]++;return Promise.all([User.findById(userId).lean(),Post.findById(postId)]).then(([user,post])=>{cov_sgojlti7r().f[1]++;cov_sgojlti7r().s[7]++;if(!post){cov_sgojlti7r().b[0][0]++;cov_sgojlti7r().s[8]++;throw new Error('post not found');}else{cov_sgojlti7r().b[0][1]++;}cov_sgojlti7r().s[9]++;if(!user){cov_sgojlti7r().b[1][0]++;cov_sgojlti7r().s[10]++;throw new Error('user not found');}else{cov_sgojlti7r().b[1][1]++;}cov_sgojlti7r().s[11]++;if(post.author.toString()!==userId){cov_sgojlti7r().b[2][0]++;cov_sgojlti7r().s[12]++;throw new Error('user and author of post is different');}else{cov_sgojlti7r().b[2][1]++;}cov_sgojlti7r().s[13]++;post.image=image;cov_sgojlti7r().s[14]++;post.text=text;cov_sgojlti7r().s[15]++;return post.save();}).then(()=>{cov_sgojlti7r().f[2]++;});}cov_sgojlti7r().s[16]++;module.exports=editPost;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3Zfc2dvamx0aTdyIiwiYWN0dWFsQ292ZXJhZ2UiLCJVc2VyIiwiUG9zdCIsInMiLCJyZXF1aXJlIiwidmFsaWRhdGVJZCIsInZhbGlkYXRlSW1hZ2UiLCJ2YWxpZGF0ZVRleHQiLCJlZGl0UG9zdCIsInVzZXJJZCIsInBvc3RJZCIsImltYWdlIiwidGV4dCIsImYiLCJQcm9taXNlIiwiYWxsIiwiZmluZEJ5SWQiLCJsZWFuIiwidGhlbiIsInVzZXIiLCJwb3N0IiwiYiIsIkVycm9yIiwiYXV0aG9yIiwidG9TdHJpbmciLCJzYXZlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbImVkaXRQb3N0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgVXNlciwgUG9zdCB9ID0gcmVxdWlyZSgnLi4vLi4vZGF0YS9tb2RlbHMnKVxyXG5jb25zdCB7IHZhbGlkYXRlSWQsIHZhbGlkYXRlSW1hZ2UsIHZhbGlkYXRlVGV4dCB9ID0gcmVxdWlyZSgnLi4vaGVscGVycy92YWxpZGF0b3JzJylcclxuXHJcbmZ1bmN0aW9uIGVkaXRQb3N0KHVzZXJJZCwgcG9zdElkLCBpbWFnZSwgdGV4dCkge1xyXG4gICAgdmFsaWRhdGVJZCh1c2VySWQpXHJcbiAgICB2YWxpZGF0ZUlkKHBvc3RJZClcclxuICAgIHZhbGlkYXRlSW1hZ2UoaW1hZ2UpXHJcbiAgICB2YWxpZGF0ZVRleHQodGV4dClcclxuXHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW1VzZXIuZmluZEJ5SWQodXNlcklkKS5sZWFuKCksIFBvc3QuZmluZEJ5SWQocG9zdElkKV0pXHJcbiAgICAgICAgLnRoZW4oKFt1c2VyLCBwb3N0XSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoIXBvc3QpIHRocm93IG5ldyBFcnJvcigncG9zdCBub3QgZm91bmQnKVxyXG4gICAgICAgICAgICBpZiAoIXVzZXIpIHRocm93IG5ldyBFcnJvcigndXNlciBub3QgZm91bmQnKVxyXG5cclxuICAgICAgICAgICAgaWYgKHBvc3QuYXV0aG9yLnRvU3RyaW5nKCkgIT09IHVzZXJJZCkgdGhyb3cgbmV3IEVycm9yKCd1c2VyIGFuZCBhdXRob3Igb2YgcG9zdCBpcyBkaWZmZXJlbnQnKVxyXG5cclxuICAgICAgICAgICAgcG9zdC5pbWFnZSA9IGltYWdlXHJcbiAgICAgICAgICAgIHBvc3QudGV4dCA9IHRleHRcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBwb3N0LnNhdmUoKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLnRoZW4oKCkgPT4geyB9KVxyXG59XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGVkaXRQb3N0Il0sIm1hcHBpbmdzIjoiZzFGQWVZO0FBQUFBLGFBQUEsU0FBQUEsQ0FBQSxTQUFBQyxjQUFBLFdBQUFBLGNBQUEsRUFBQUQsYUFBQSxHQWZaLEtBQU0sQ0FBRUUsSUFBSSxDQUFFQyxJQUFLLENBQUMsRUFBQUgsYUFBQSxHQUFBSSxDQUFBLE1BQUdDLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxFQUNuRCxLQUFNLENBQUVDLFVBQVUsQ0FBRUMsYUFBYSxDQUFFQyxZQUFhLENBQUMsRUFBQVIsYUFBQSxHQUFBSSxDQUFBLE1BQUdDLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQyxFQUVwRixRQUFTLENBQUFJLFFBQVFBLENBQUNDLE1BQU0sQ0FBRUMsTUFBTSxDQUFFQyxLQUFLLENBQUVDLElBQUksQ0FBRSxDQUFBYixhQUFBLEdBQUFjLENBQUEsTUFBQWQsYUFBQSxHQUFBSSxDQUFBLE1BQzNDRSxVQUFVLENBQUNJLE1BQU0sQ0FBQyxDQUFBVixhQUFBLEdBQUFJLENBQUEsTUFDbEJFLFVBQVUsQ0FBQ0ssTUFBTSxDQUFDLENBQUFYLGFBQUEsR0FBQUksQ0FBQSxNQUNsQkcsYUFBYSxDQUFDSyxLQUFLLENBQUMsQ0FBQVosYUFBQSxHQUFBSSxDQUFBLE1BQ3BCSSxZQUFZLENBQUNLLElBQUksQ0FBQyxDQUFBYixhQUFBLEdBQUFJLENBQUEsTUFFbEIsTUFBTyxDQUFBVyxPQUFPLENBQUNDLEdBQUcsQ0FBQyxDQUFDZCxJQUFJLENBQUNlLFFBQVEsQ0FBQ1AsTUFBTSxDQUFDLENBQUNRLElBQUksQ0FBQyxDQUFDLENBQUVmLElBQUksQ0FBQ2MsUUFBUSxDQUFDTixNQUFNLENBQUMsQ0FBQyxDQUFDLENBQ3BFUSxJQUFJLENBQUMsQ0FBQyxDQUFDQyxJQUFJLENBQUVDLElBQUksQ0FBQyxHQUFLLENBQUFyQixhQUFBLEdBQUFjLENBQUEsTUFBQWQsYUFBQSxHQUFBSSxDQUFBLE1BQ3BCLEdBQUksQ0FBQ2lCLElBQUksQ0FBRSxDQUFBckIsYUFBQSxHQUFBc0IsQ0FBQSxTQUFBdEIsYUFBQSxHQUFBSSxDQUFBLFdBQU0sSUFBSSxDQUFBbUIsS0FBSyxDQUFDLGdCQUFnQixDQUFDLENBQUQsQ0FBQyxLQUFBdkIsYUFBQSxHQUFBc0IsQ0FBQSxVQUFBdEIsYUFBQSxHQUFBSSxDQUFBLE1BQzVDLEdBQUksQ0FBQ2dCLElBQUksQ0FBRSxDQUFBcEIsYUFBQSxHQUFBc0IsQ0FBQSxTQUFBdEIsYUFBQSxHQUFBSSxDQUFBLFlBQU0sSUFBSSxDQUFBbUIsS0FBSyxDQUFDLGdCQUFnQixDQUFDLENBQUQsQ0FBQyxLQUFBdkIsYUFBQSxHQUFBc0IsQ0FBQSxVQUFBdEIsYUFBQSxHQUFBSSxDQUFBLE9BRTVDLEdBQUlpQixJQUFJLENBQUNHLE1BQU0sQ0FBQ0MsUUFBUSxDQUFDLENBQUMsR0FBS2YsTUFBTSxDQUFFLENBQUFWLGFBQUEsR0FBQXNCLENBQUEsU0FBQXRCLGFBQUEsR0FBQUksQ0FBQSxZQUFNLElBQUksQ0FBQW1CLEtBQUssQ0FBQyxzQ0FBc0MsQ0FBQyxDQUFELENBQUMsS0FBQXZCLGFBQUEsR0FBQXNCLENBQUEsVUFBQXRCLGFBQUEsR0FBQUksQ0FBQSxPQUU5RmlCLElBQUksQ0FBQ1QsS0FBSyxDQUFHQSxLQUFLLENBQUFaLGFBQUEsR0FBQUksQ0FBQSxPQUNsQmlCLElBQUksQ0FBQ1IsSUFBSSxDQUFHQSxJQUFJLENBQUFiLGFBQUEsR0FBQUksQ0FBQSxPQUVoQixNQUFPLENBQUFpQixJQUFJLENBQUNLLElBQUksQ0FBQyxDQUFDLENBQ3RCLENBQUMsQ0FBQyxDQUNEUCxJQUFJLENBQUMsSUFBTSxDQUFBbkIsYUFBQSxHQUFBYyxDQUFBLE1BQUUsQ0FBQyxDQUFDLENBQ3hCLENBQUNkLGFBQUEsR0FBQUksQ0FBQSxPQUVEdUIsTUFBTSxDQUFDQyxPQUFPLENBQUduQixRQUFRIn0=