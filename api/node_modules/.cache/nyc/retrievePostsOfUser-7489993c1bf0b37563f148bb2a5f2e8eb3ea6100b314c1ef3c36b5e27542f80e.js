function cov_1e1yrksdwz(){var path="C:\\Users\\loco8\\workspace\\eurofirms-bootcamp-202305\\staff\\manuel-david-castillo\\instaflan-fullstack\\api\\logic\\post-logic\\retrievePostsOfUser.js";var hash="cdc86cca30f229774be2e308adbe9861952a8b67";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\loco8\\workspace\\eurofirms-bootcamp-202305\\staff\\manuel-david-castillo\\instaflan-fullstack\\api\\logic\\post-logic\\retrievePostsOfUser.js",statementMap:{"0":{start:{line:1,column:23},end:{line:1,column:51}},"1":{start:{line:2,column:23},end:{line:2,column:55}},"2":{start:{line:5,column:4},end:{line:5,column:22}},"3":{start:{line:7,column:4},end:{line:44,column:10}},"4":{start:{line:13,column:12},end:{line:13,column:56}},"5":{start:{line:13,column:23},end:{line:13,column:56}},"6":{start:{line:14,column:12},end:{line:14,column:58}},"7":{start:{line:14,column:24},end:{line:14,column:58}},"8":{start:{line:16,column:12},end:{line:41,column:14}},"9":{start:{line:17,column:16},end:{line:17,column:45}},"10":{start:{line:18,column:16},end:{line:18,column:31}},"11":{start:{line:20,column:16},end:{line:24,column:17}},"12":{start:{line:21,column:20},end:{line:21,column:63}},"13":{start:{line:23,column:20},end:{line:23,column:42}},"14":{start:{line:26,column:33},end:{line:28,column:18}},"15":{start:{line:27,column:20},end:{line:27,column:42}},"16":{start:{line:30,column:16},end:{line:30,column:53}},"17":{start:{line:32,column:16},end:{line:40,column:18}},"18":{start:{line:33,column:20},end:{line:33,column:55}},"19":{start:{line:34,column:20},end:{line:34,column:38}},"20":{start:{line:36,column:20},end:{line:39,column:21}},"21":{start:{line:37,column:24},end:{line:37,column:62}},"22":{start:{line:38,column:24},end:{line:38,column:49}},"23":{start:{line:43,column:12},end:{line:43,column:24}},"24":{start:{line:47,column:0},end:{line:47,column:36}}},fnMap:{"0":{name:"retrievePostsOfUser",decl:{start:{line:4,column:9},end:{line:4,column:28}},loc:{start:{line:4,column:52},end:{line:45,column:1}},line:4},"1":{name:"(anonymous_1)",decl:{start:{line:12,column:14},end:{line:12,column:15}},loc:{start:{line:12,column:33},end:{line:44,column:9}},line:12},"2":{name:"(anonymous_2)",decl:{start:{line:16,column:26},end:{line:16,column:27}},loc:{start:{line:16,column:34},end:{line:41,column:13}},line:16},"3":{name:"(anonymous_3)",decl:{start:{line:26,column:51},end:{line:26,column:52}},loc:{start:{line:26,column:61},end:{line:28,column:17}},line:26},"4":{name:"(anonymous_4)",decl:{start:{line:32,column:38},end:{line:32,column:39}},loc:{start:{line:32,column:49},end:{line:40,column:17}},line:32}},branchMap:{"0":{loc:{start:{line:13,column:12},end:{line:13,column:56}},type:"if",locations:[{start:{line:13,column:12},end:{line:13,column:56}},{start:{line:13,column:12},end:{line:13,column:56}}],line:13},"1":{loc:{start:{line:14,column:12},end:{line:14,column:58}},type:"if",locations:[{start:{line:14,column:12},end:{line:14,column:58}},{start:{line:14,column:12},end:{line:14,column:58}}],line:14},"2":{loc:{start:{line:20,column:16},end:{line:24,column:17}},type:"if",locations:[{start:{line:20,column:16},end:{line:24,column:17}},{start:{line:20,column:16},end:{line:24,column:17}}],line:20},"3":{loc:{start:{line:36,column:20},end:{line:39,column:21}},type:"if",locations:[{start:{line:36,column:20},end:{line:39,column:21}},{start:{line:36,column:20},end:{line:39,column:21}}],line:36}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"cdc86cca30f229774be2e308adbe9861952a8b67"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1e1yrksdwz=function(){return actualCoverage;};}return actualCoverage;}cov_1e1yrksdwz();const{User,Post}=(cov_1e1yrksdwz().s[0]++,require('../../data/models'));const{validateId}=(cov_1e1yrksdwz().s[1]++,require('../helpers/validators'));function retrievePostsOfUser(userId,userIdProfile){cov_1e1yrksdwz().f[0]++;cov_1e1yrksdwz().s[2]++;validateId(userId);cov_1e1yrksdwz().s[3]++;return Promise.all([User.findById(userId).lean(),Post.find({author:userIdProfile},'-__v').populate('author','name image').populate({path:'comments.author',select:'name image'}).sort({date:-1}).lean()]).then(([user,posts])=>{cov_1e1yrksdwz().f[1]++;cov_1e1yrksdwz().s[4]++;if(!user){cov_1e1yrksdwz().b[0][0]++;cov_1e1yrksdwz().s[5]++;throw new Error('user not found');}else{cov_1e1yrksdwz().b[0][1]++;}cov_1e1yrksdwz().s[6]++;if(!posts){cov_1e1yrksdwz().b[1][0]++;cov_1e1yrksdwz().s[7]++;throw new Error('posts not found');}else{cov_1e1yrksdwz().b[1][1]++;}cov_1e1yrksdwz().s[8]++;posts.forEach(post=>{cov_1e1yrksdwz().f[2]++;cov_1e1yrksdwz().s[9]++;post.id=post._id.toString();cov_1e1yrksdwz().s[10]++;delete post._id;cov_1e1yrksdwz().s[11]++;if(post.author._id){cov_1e1yrksdwz().b[2][0]++;cov_1e1yrksdwz().s[12]++;post.author.id=post.author._id.toString();cov_1e1yrksdwz().s[13]++;delete post.author._id;}else{cov_1e1yrksdwz().b[2][1]++;}const favPosts=(cov_1e1yrksdwz().s[14]++,user.favPosts.map(post=>{cov_1e1yrksdwz().f[3]++;cov_1e1yrksdwz().s[15]++;return post.toString();}));cov_1e1yrksdwz().s[16]++;post.fav=favPosts.includes(post.id);cov_1e1yrksdwz().s[17]++;post.comments.forEach(comment=>{cov_1e1yrksdwz().f[4]++;cov_1e1yrksdwz().s[18]++;comment.id=comment._id.toString();cov_1e1yrksdwz().s[19]++;delete comment._id;cov_1e1yrksdwz().s[20]++;if(comment.author._id){cov_1e1yrksdwz().b[3][0]++;cov_1e1yrksdwz().s[21]++;comment.author.id=comment.author._id;cov_1e1yrksdwz().s[22]++;delete comment.author._id;}else{cov_1e1yrksdwz().b[3][1]++;}});});cov_1e1yrksdwz().s[23]++;return posts;});}cov_1e1yrksdwz().s[24]++;module.exports=retrievePostsOfUser;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMWUxeXJrc2R3eiIsImFjdHVhbENvdmVyYWdlIiwiVXNlciIsIlBvc3QiLCJzIiwicmVxdWlyZSIsInZhbGlkYXRlSWQiLCJyZXRyaWV2ZVBvc3RzT2ZVc2VyIiwidXNlcklkIiwidXNlcklkUHJvZmlsZSIsImYiLCJQcm9taXNlIiwiYWxsIiwiZmluZEJ5SWQiLCJsZWFuIiwiZmluZCIsImF1dGhvciIsInBvcHVsYXRlIiwicGF0aCIsInNlbGVjdCIsInNvcnQiLCJkYXRlIiwidGhlbiIsInVzZXIiLCJwb3N0cyIsImIiLCJFcnJvciIsImZvckVhY2giLCJwb3N0IiwiaWQiLCJfaWQiLCJ0b1N0cmluZyIsImZhdlBvc3RzIiwibWFwIiwiZmF2IiwiaW5jbHVkZXMiLCJjb21tZW50cyIsImNvbW1lbnQiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsicmV0cmlldmVQb3N0c09mVXNlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IFVzZXIsIFBvc3QgfSA9IHJlcXVpcmUoJy4uLy4uL2RhdGEvbW9kZWxzJylcclxuY29uc3QgeyB2YWxpZGF0ZUlkIH0gPSByZXF1aXJlKCcuLi9oZWxwZXJzL3ZhbGlkYXRvcnMnKVxyXG5cclxuZnVuY3Rpb24gcmV0cmlldmVQb3N0c09mVXNlcih1c2VySWQsIHVzZXJJZFByb2ZpbGUpIHtcclxuICAgIHZhbGlkYXRlSWQodXNlcklkKVxyXG5cclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbVXNlci5maW5kQnlJZCh1c2VySWQpLmxlYW4oKSxcclxuICAgIFBvc3QuZmluZCh7IGF1dGhvcjogdXNlcklkUHJvZmlsZSB9LCAnLV9fdicpXHJcbiAgICAgICAgLnBvcHVsYXRlKCdhdXRob3InLCAnbmFtZSBpbWFnZScpXHJcbiAgICAgICAgLnBvcHVsYXRlKHsgcGF0aDogJ2NvbW1lbnRzLmF1dGhvcicsIHNlbGVjdDogJ25hbWUgaW1hZ2UnIH0pXHJcbiAgICAgICAgLnNvcnQoeyBkYXRlOiAtMSB9KS5sZWFuKCldKVxyXG4gICAgICAgIC50aGVuKChbdXNlciwgcG9zdHNdKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICghdXNlcikgdGhyb3cgbmV3IEVycm9yKCd1c2VyIG5vdCBmb3VuZCcpXHJcbiAgICAgICAgICAgIGlmICghcG9zdHMpIHRocm93IG5ldyBFcnJvcigncG9zdHMgbm90IGZvdW5kJylcclxuXHJcbiAgICAgICAgICAgIHBvc3RzLmZvckVhY2gocG9zdCA9PiB7XHJcbiAgICAgICAgICAgICAgICBwb3N0LmlkID0gcG9zdC5faWQudG9TdHJpbmcoKVxyXG4gICAgICAgICAgICAgICAgZGVsZXRlIHBvc3QuX2lkXHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHBvc3QuYXV0aG9yLl9pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBvc3QuYXV0aG9yLmlkID0gcG9zdC5hdXRob3IuX2lkLnRvU3RyaW5nKClcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHBvc3QuYXV0aG9yLl9pZFxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGNvbnN0IGZhdlBvc3RzID0gdXNlci5mYXZQb3N0cy5tYXAoKHBvc3QpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcG9zdC50b1N0cmluZygpXHJcbiAgICAgICAgICAgICAgICB9KVxyXG5cclxuICAgICAgICAgICAgICAgIHBvc3QuZmF2ID0gZmF2UG9zdHMuaW5jbHVkZXMocG9zdC5pZClcclxuXHJcbiAgICAgICAgICAgICAgICBwb3N0LmNvbW1lbnRzLmZvckVhY2goY29tbWVudCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29tbWVudC5pZCA9IGNvbW1lbnQuX2lkLnRvU3RyaW5nKClcclxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgY29tbWVudC5faWRcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbW1lbnQuYXV0aG9yLl9pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21tZW50LmF1dGhvci5pZCA9IGNvbW1lbnQuYXV0aG9yLl9pZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgY29tbWVudC5hdXRob3IuX2lkXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBwb3N0c1xyXG4gICAgICAgIH0pXHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcmV0cmlldmVQb3N0c09mVXNlciJdLCJtYXBwaW5ncyI6InUzSEFlWTtBQUFBQSxjQUFBLFNBQUFBLENBQUEsU0FBQUMsY0FBQSxXQUFBQSxjQUFBLEVBQUFELGNBQUEsR0FmWixLQUFNLENBQUVFLElBQUksQ0FBRUMsSUFBSyxDQUFDLEVBQUFILGNBQUEsR0FBQUksQ0FBQSxNQUFHQyxPQUFPLENBQUMsbUJBQW1CLENBQUMsRUFDbkQsS0FBTSxDQUFFQyxVQUFXLENBQUMsRUFBQU4sY0FBQSxHQUFBSSxDQUFBLE1BQUdDLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQyxFQUV2RCxRQUFTLENBQUFFLG1CQUFtQkEsQ0FBQ0MsTUFBTSxDQUFFQyxhQUFhLENBQUUsQ0FBQVQsY0FBQSxHQUFBVSxDQUFBLE1BQUFWLGNBQUEsR0FBQUksQ0FBQSxNQUNoREUsVUFBVSxDQUFDRSxNQUFNLENBQUMsQ0FBQVIsY0FBQSxHQUFBSSxDQUFBLE1BRWxCLE1BQU8sQ0FBQU8sT0FBTyxDQUFDQyxHQUFHLENBQUMsQ0FBQ1YsSUFBSSxDQUFDVyxRQUFRLENBQUNMLE1BQU0sQ0FBQyxDQUFDTSxJQUFJLENBQUMsQ0FBQyxDQUNoRFgsSUFBSSxDQUFDWSxJQUFJLENBQUMsQ0FBRUMsTUFBTSxDQUFFUCxhQUFjLENBQUMsQ0FBRSxNQUFNLENBQUMsQ0FDdkNRLFFBQVEsQ0FBQyxRQUFRLENBQUUsWUFBWSxDQUFDLENBQ2hDQSxRQUFRLENBQUMsQ0FBRUMsSUFBSSxDQUFFLGlCQUFp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