function cov_192vwfegbk(){var path="C:\\Users\\loco8\\workspace\\eurofirms-bootcamp-202305\\staff\\manuel-david-castillo\\instaflan-fullstack\\api\\logic\\chats-logic\\retrieveChats.js";var hash="83fd0b9ab4b19cfc55c3ad56d92cc2f329c6151f";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\loco8\\workspace\\eurofirms-bootcamp-202305\\staff\\manuel-david-castillo\\instaflan-fullstack\\api\\logic\\chats-logic\\retrieveChats.js",statementMap:{"0":{start:{line:1,column:17},end:{line:1,column:45}},"1":{start:{line:2,column:23},end:{line:2,column:55}},"2":{start:{line:5,column:4},end:{line:5,column:22}},"3":{start:{line:7,column:4},end:{line:30,column:10}},"4":{start:{line:11,column:12},end:{line:27,column:14}},"5":{start:{line:12,column:16},end:{line:12,column:34}},"6":{start:{line:13,column:16},end:{line:13,column:31}},"7":{start:{line:15,column:30},end:{line:15,column:90}},"8":{start:{line:15,column:59},end:{line:15,column:89}},"9":{start:{line:16,column:16},end:{line:16,column:43}},"10":{start:{line:18,column:16},end:{line:21,column:18}},"11":{start:{line:19,column:20},end:{line:19,column:38}},"12":{start:{line:20,column:20},end:{line:20,column:35}},"13":{start:{line:23,column:16},end:{line:26,column:18}},"14":{start:{line:24,column:20},end:{line:24,column:44}},"15":{start:{line:25,column:20},end:{line:25,column:38}},"16":{start:{line:29,column:12},end:{line:29,column:24}},"17":{start:{line:33,column:0},end:{line:33,column:30}}},fnMap:{"0":{name:"retrieveChats",decl:{start:{line:4,column:9},end:{line:4,column:22}},loc:{start:{line:4,column:31},end:{line:31,column:1}},line:4},"1":{name:"(anonymous_1)",decl:{start:{line:9,column:14},end:{line:9,column:15}},loc:{start:{line:9,column:23},end:{line:30,column:9}},line:9},"2":{name:"(anonymous_2)",decl:{start:{line:11,column:26},end:{line:11,column:27}},loc:{start:{line:11,column:34},end:{line:27,column:13}},line:11},"3":{name:"(anonymous_3)",decl:{start:{line:15,column:51},end:{line:15,column:52}},loc:{start:{line:15,column:59},end:{line:15,column:89}},line:15},"4":{name:"(anonymous_4)",decl:{start:{line:18,column:35},end:{line:18,column:36}},loc:{start:{line:18,column:43},end:{line:21,column:17}},line:18},"5":{name:"(anonymous_5)",decl:{start:{line:23,column:38},end:{line:23,column:39}},loc:{start:{line:23,column:49},end:{line:26,column:17}},line:23}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"83fd0b9ab4b19cfc55c3ad56d92cc2f329c6151f"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_192vwfegbk=function(){return actualCoverage;};}return actualCoverage;}cov_192vwfegbk();const{Chat}=(cov_192vwfegbk().s[0]++,require("../../data/models"));const{validateId}=(cov_192vwfegbk().s[1]++,require("../helpers/validators"));function retrieveChats(userId){cov_192vwfegbk().f[0]++;cov_192vwfegbk().s[2]++;validateId(userId);cov_192vwfegbk().s[3]++;return Chat.find({users:userId},'-__v').populate('users','name image').sort({date:-1}).lean().then(chats=>{cov_192vwfegbk().f[1]++;cov_192vwfegbk().s[4]++;chats.forEach(chat=>{cov_192vwfegbk().f[2]++;cov_192vwfegbk().s[5]++;chat.id=chat._id;cov_192vwfegbk().s[6]++;delete chat._id;const index=(cov_192vwfegbk().s[7]++,chat.users.findIndex(user=>{cov_192vwfegbk().f[3]++;cov_192vwfegbk().s[8]++;return user._id.toString()===userId;}));cov_192vwfegbk().s[9]++;chat.users.splice(index,1);cov_192vwfegbk().s[10]++;chat.users.forEach(user=>{cov_192vwfegbk().f[4]++;cov_192vwfegbk().s[11]++;user.id=user._id;cov_192vwfegbk().s[12]++;delete user._id;});cov_192vwfegbk().s[13]++;chat.messages.forEach(message=>{cov_192vwfegbk().f[5]++;cov_192vwfegbk().s[14]++;message.id=message._id;cov_192vwfegbk().s[15]++;delete message._id;});});cov_192vwfegbk().s[16]++;return chats;});}cov_192vwfegbk().s[17]++;module.exports=retrieveChats;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMTkydndmZWdiayIsImFjdHVhbENvdmVyYWdlIiwiQ2hhdCIsInMiLCJyZXF1aXJlIiwidmFsaWRhdGVJZCIsInJldHJpZXZlQ2hhdHMiLCJ1c2VySWQiLCJmIiwiZmluZCIsInVzZXJzIiwicG9wdWxhdGUiLCJzb3J0IiwiZGF0ZSIsImxlYW4iLCJ0aGVuIiwiY2hhdHMiLCJmb3JFYWNoIiwiY2hhdCIsImlkIiwiX2lkIiwiaW5kZXgiLCJmaW5kSW5kZXgiLCJ1c2VyIiwidG9TdHJpbmciLCJzcGxpY2UiLCJtZXNzYWdlcyIsIm1lc3NhZ2UiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsicmV0cmlldmVDaGF0cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IENoYXQgfSA9IHJlcXVpcmUoXCIuLi8uLi9kYXRhL21vZGVsc1wiKTtcclxuY29uc3QgeyB2YWxpZGF0ZUlkIH0gPSByZXF1aXJlKFwiLi4vaGVscGVycy92YWxpZGF0b3JzXCIpO1xyXG5cclxuZnVuY3Rpb24gcmV0cmlldmVDaGF0cyh1c2VySWQpIHtcclxuICAgIHZhbGlkYXRlSWQodXNlcklkKVxyXG5cclxuICAgIHJldHVybiBDaGF0LmZpbmQoeyB1c2VyczogdXNlcklkIH0sICctX192JylcclxuICAgICAgICAucG9wdWxhdGUoJ3VzZXJzJywgJ25hbWUgaW1hZ2UnKS5zb3J0KHsgZGF0ZTogLTEgfSkubGVhbigpXHJcbiAgICAgICAgLnRoZW4oY2hhdHMgPT4ge1xyXG5cclxuICAgICAgICAgICAgY2hhdHMuZm9yRWFjaChjaGF0ID0+IHtcclxuICAgICAgICAgICAgICAgIGNoYXQuaWQgPSBjaGF0Ll9pZFxyXG4gICAgICAgICAgICAgICAgZGVsZXRlIGNoYXQuX2lkXHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSBjaGF0LnVzZXJzLmZpbmRJbmRleCh1c2VyID0+IHVzZXIuX2lkLnRvU3RyaW5nKCkgPT09IHVzZXJJZClcclxuICAgICAgICAgICAgICAgIGNoYXQudXNlcnMuc3BsaWNlKGluZGV4LCAxKVxyXG5cclxuICAgICAgICAgICAgICAgIGNoYXQudXNlcnMuZm9yRWFjaCh1c2VyID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB1c2VyLmlkID0gdXNlci5faWRcclxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgdXNlci5faWRcclxuICAgICAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICAgICAgY2hhdC5tZXNzYWdlcy5mb3JFYWNoKG1lc3NhZ2UgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UuaWQgPSBtZXNzYWdlLl9pZFxyXG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBtZXNzYWdlLl9pZFxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBjaGF0c1xyXG4gICAgICAgIH0pXHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcmV0cmlldmVDaGF0cyJdLCJtYXBwaW5ncyI6InV3RkFlWTtBQUFBQSxjQUFBLFNBQUFBLENBQUEsU0FBQUMsY0FBQSxXQUFBQSxjQUFBLEVBQUFELGNBQUEsR0FmWixLQUFNLENBQUVFLElBQUssQ0FBQyxFQUFBRixjQUFBLEdBQUFHLENBQUEsTUFBR0MsT0FBTyxDQUFDLG1CQUFtQixDQUFDLEVBQzdDLEtBQU0sQ0FBRUMsVUFBVyxDQUFDLEVBQUFMLGNBQUEsR0FBQUcsQ0FBQSxNQUFHQyxPQUFPLENBQUMsdUJBQXVCLENBQUMsRUFFdkQsUUFBUyxDQUFBRSxhQUFhQSxDQUFDQyxNQUFNLENBQUUsQ0FBQVAsY0FBQSxHQUFBUSxDQUFBLE1BQUFSLGNBQUEsR0FBQUcsQ0FBQSxNQUMzQkUsVUFBVSxDQUFDRSxNQUFNLENBQUMsQ0FBQVAsY0FBQSxHQUFBRyxDQUFBLE1BRWxCLE1BQU8sQ0FBQUQsSUFBSSxDQUFDTyxJQUFJLENBQUMsQ0FBRUMsS0FBSyxDQUFFSCxNQUFPLENBQUMsQ0FBRSxNQUFNLENBQUMsQ0FDdENJLFFBQVEsQ0FBQyxPQUFPLENBQUUsWUFBWSxDQUFDLENBQUNDLElBQUksQ0FBQyxDQUFFQyxJQUFJLENBQUUsQ0FBQyxDQUFFLENBQUMsQ0FBQyxDQUFDQyxJQUFJLENBQUMsQ0FBQyxDQUN6REMsSUFBSSxDQUFDQyxLQUFLLEVBQUksQ0FBQWhCLGNBQUEsR0FBQVEsQ0FBQSxNQUFBUixjQUFBLEdBQUFHLENBQUEsTUFFWGEsS0FBSyxDQUFDQyxPQUFPLENBQUNDLElBQUksRUFBSSxDQUFBbEIsY0FBQSxHQUFBUSxDQUFBLE1BQUFSLGNBQUEsR0FBQUcsQ0FBQSxNQUNsQmUsSUFBSSxDQUFDQyxFQUFFLENBQUdELElBQUksQ0FBQ0UsR0FBRyxDQUFBcEIsY0FBQSxHQUFBRyxDQUFBLE1BQ2xCLE1BQU8sQ0FBQWUsSUFBSSxDQUFDRSxHQUFHLENBRWYsS0FBTSxDQUFBQyxLQUFLLEVBQUFyQixjQUFBLEdBQUFHLENBQUEsTUFBR2UsSUFBSSxDQUFDUixLQUFLLENBQUNZLFNBQVMsQ0FBQ0MsSUFBSSxFQUFJLENBQUF2QixjQUFBLEdBQUFRLENBQUEsTUFBQVIsY0FBQSxHQUFBRyxDQUFBLGFBQUFvQixJQUFJLENBQUNILEdBQUcsQ0FBQ0ksUUFBUSxDQUFDLENBQUMsR0FBS2pCLE1BQU0sQ0FBRCxDQUFDLENBQUMsRUFBQVAsY0FBQSxHQUFBRyxDQUFBLE1BQzFFZSxJQUFJLENBQUNSLEtBQUssQ0FBQ2UsTUFBTSxDQUFDSixLQUFLLENBQUUsQ0FBQyxDQUFDLENBQUFyQixjQUFBLEdBQUFHLENBQUEsT0FFM0JlLElBQUksQ0FBQ1IsS0FBSyxDQUFDTyxPQUFPLENBQUNNLElBQUksRUFBSSxDQUFBdkIsY0FBQSxHQUFBUSxDQUFBLE1BQUFSLGNBQUEsR0FBQUcsQ0FBQSxPQUN2Qm9CLElBQUksQ0FBQ0osRUFBRSxDQUFHSSxJQUFJLENBQUNILEdBQUcsQ0FBQXBCLGNBQUEsR0FBQUcsQ0FBQSxPQUNsQixNQUFPLENBQUFvQixJQUFJLENBQUNILEdBQUcsQ0FDbkIsQ0FBQyxDQUFDLENBQUFwQixjQUFBLEdBQUFHLENBQUEsT0FFRmUsSUFBSSxDQUFDUSxRQUFRLENBQUNULE9BQU8sQ0FBQ1UsT0FBTyxFQUFJLENBQUEzQixjQUFBLEdBQUFRLENBQUEsTUFBQVIsY0FBQSxHQUFBRyxDQUFBLE9BQzdCd0IsT0FBTyxDQUFDUixFQUFFLENBQUdRLE9BQU8sQ0FBQ1AsR0FBRyxDQUFBcEIsY0FBQSxHQUFBRyxDQUFBLE9BQ3hCLE1BQU8sQ0FBQXdCLE9BQU8sQ0FBQ1AsR0FBRyxDQUN0QixDQUFDLENBQUMsQ0FDTixDQUFDLENBQUMsQ0FBQXBCLGNBQUEsR0FBQUcsQ0FBQSxPQUVGLE1BQU8sQ0FBQWEsS0FBSyxDQUNoQixDQUFDLENBQUMsQ0FDVixDQUFDaEIsY0FBQSxHQUFBRyxDQUFBLE9BRUR5QixNQUFNLENBQUNDLE9BQU8sQ0FBR3ZCLGFBQWEifQ==