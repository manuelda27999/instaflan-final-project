function cov_2masmv6kc6(){var path="C:\\Users\\loco8\\workspace\\eurofirms-bootcamp-202305\\staff\\manuel-david-castillo\\instaflan-fullstack\\api\\logic\\user-logic\\retrieveUsersNotFollowed.js";var hash="1f16bc18c645c438fe21b3f9636cb2fd3c0589f8";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\loco8\\workspace\\eurofirms-bootcamp-202305\\staff\\manuel-david-castillo\\instaflan-fullstack\\api\\logic\\user-logic\\retrieveUsersNotFollowed.js",statementMap:{"0":{start:{line:1,column:17},end:{line:1,column:45}},"1":{start:{line:2,column:23},end:{line:2,column:55}},"2":{start:{line:5,column:4},end:{line:5,column:22}},"3":{start:{line:7,column:4},end:{line:40,column:8}},"4":{start:{line:9,column:8},end:{line:9,column:51}},"5":{start:{line:9,column:18},end:{line:9,column:51}},"6":{start:{line:11,column:30},end:{line:11,column:66}},"7":{start:{line:12,column:8},end:{line:12,column:36}},"8":{start:{line:14,column:8},end:{line:30,column:9}},"9":{start:{line:33,column:8},end:{line:33,column:53}},"10":{start:{line:33,column:19},end:{line:33,column:53}},"11":{start:{line:35,column:8},end:{line:37,column:10}},"12":{start:{line:36,column:10},end:{line:36,column:25}},"13":{start:{line:39,column:8},end:{line:39,column:20}},"14":{start:{line:43,column:0},end:{line:43,column:41}}},fnMap:{"0":{name:"retrieveUsersNotFollowed",decl:{start:{line:4,column:9},end:{line:4,column:33}},loc:{start:{line:4,column:42},end:{line:41,column:1}},line:4},"1":{name:"(anonymous_1)",decl:{start:{line:8,column:10},end:{line:8,column:11}},loc:{start:{line:8,column:18},end:{line:31,column:7}},line:8},"2":{name:"(anonymous_2)",decl:{start:{line:32,column:12},end:{line:32,column:13}},loc:{start:{line:32,column:21},end:{line:40,column:7}},line:32},"3":{name:"(anonymous_3)",decl:{start:{line:35,column:22},end:{line:35,column:23}},loc:{start:{line:35,column:30},end:{line:37,column:9}},line:35}},branchMap:{"0":{loc:{start:{line:9,column:8},end:{line:9,column:51}},type:"if",locations:[{start:{line:9,column:8},end:{line:9,column:51}},{start:{line:9,column:8},end:{line:9,column:51}}],line:9},"1":{loc:{start:{line:11,column:30},end:{line:11,column:66}},type:"cond-expr",locations:[{start:{line:11,column:47},end:{line:11,column:61}},{start:{line:11,column:64},end:{line:11,column:66}}],line:11},"2":{loc:{start:{line:33,column:8},end:{line:33,column:53}},type:"if",locations:[{start:{line:33,column:8},end:{line:33,column:53}},{start:{line:33,column:8},end:{line:33,column:53}}],line:33}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},f:{"0":0,"1":0,"2":0,"3":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"1f16bc18c645c438fe21b3f9636cb2fd3c0589f8"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2masmv6kc6=function(){return actualCoverage;};}return actualCoverage;}cov_2masmv6kc6();const{User}=(cov_2masmv6kc6().s[0]++,require("../../data/models"));const{validateId}=(cov_2masmv6kc6().s[1]++,require("../helpers/validators"));function retrieveUsersNotFollowed(userId){cov_2masmv6kc6().f[0]++;cov_2masmv6kc6().s[2]++;validateId(userId);cov_2masmv6kc6().s[3]++;return User.findById(userId).lean().then(user=>{cov_2masmv6kc6().f[1]++;cov_2masmv6kc6().s[4]++;if(!user){cov_2masmv6kc6().b[0][0]++;cov_2masmv6kc6().s[5]++;throw new Error('user not found');}else{cov_2masmv6kc6().b[0][1]++;}const usersFollowed=(cov_2masmv6kc6().s[6]++,user.following?(cov_2masmv6kc6().b[1][0]++,user.following):(cov_2masmv6kc6().b[1][1]++,[]));cov_2masmv6kc6().s[7]++;usersFollowed.push(user._id);cov_2masmv6kc6().s[8]++;return User.aggregate([{$match:{_id:{$nin:usersFollowed}}},{$sample:{size:4}},{$project:{id:{$toString:"$_id"},name:1,image:1}}]);}).then(users=>{cov_2masmv6kc6().f[2]++;cov_2masmv6kc6().s[9]++;if(!users){cov_2masmv6kc6().b[2][0]++;cov_2masmv6kc6().s[10]++;throw new Error('users not found');}else{cov_2masmv6kc6().b[2][1]++;}cov_2masmv6kc6().s[11]++;users.forEach(user=>{cov_2masmv6kc6().f[3]++;cov_2masmv6kc6().s[12]++;delete user._id;});cov_2masmv6kc6().s[13]++;return users;});}cov_2masmv6kc6().s[14]++;module.exports=retrieveUsersNotFollowed;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMm1hc212NmtjNiIsImFjdHVhbENvdmVyYWdlIiwiVXNlciIsInMiLCJyZXF1aXJlIiwidmFsaWRhdGVJZCIsInJldHJpZXZlVXNlcnNOb3RGb2xsb3dlZCIsInVzZXJJZCIsImYiLCJmaW5kQnlJZCIsImxlYW4iLCJ0aGVuIiwidXNlciIsImIiLCJFcnJvciIsInVzZXJzRm9sbG93ZWQiLCJmb2xsb3dpbmciLCJwdXNoIiwiX2lkIiwiYWdncmVnYXRlIiwiJG1hdGNoIiwiJG5pbiIsIiRzYW1wbGUiLCJzaXplIiwiJHByb2plY3QiLCJpZCIsIiR0b1N0cmluZyIsIm5hbWUiLCJpbWFnZSIsInVzZXJzIiwiZm9yRWFjaCIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJyZXRyaWV2ZVVzZXJzTm90Rm9sbG93ZWQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgeyBVc2VyIH0gPSByZXF1aXJlKFwiLi4vLi4vZGF0YS9tb2RlbHNcIik7XHJcbmNvbnN0IHsgdmFsaWRhdGVJZCB9ID0gcmVxdWlyZShcIi4uL2hlbHBlcnMvdmFsaWRhdG9yc1wiKTtcclxuXHJcbmZ1bmN0aW9uIHJldHJpZXZlVXNlcnNOb3RGb2xsb3dlZCh1c2VySWQpIHtcclxuICAgIHZhbGlkYXRlSWQodXNlcklkKVxyXG5cclxuICAgIHJldHVybiBVc2VyLmZpbmRCeUlkKHVzZXJJZCkubGVhbigpXHJcbiAgICAudGhlbih1c2VyID0+IHtcclxuICAgICAgICBpZighdXNlcikgdGhyb3cgbmV3IEVycm9yKCd1c2VyIG5vdCBmb3VuZCcpXHJcblxyXG4gICAgICAgIGNvbnN0IHVzZXJzRm9sbG93ZWQgPSB1c2VyLmZvbGxvd2luZyA/IHVzZXIuZm9sbG93aW5nIDogW11cclxuICAgICAgICB1c2Vyc0ZvbGxvd2VkLnB1c2godXNlci5faWQpXHJcblxyXG4gICAgICAgIHJldHVybiBVc2VyLmFnZ3JlZ2F0ZShbXHJcbiAgICAgICAgIHtcclxuICAgICAgICAgICAkbWF0Y2g6IHtcclxuICAgICAgICAgICAgIF9pZDogeyAkbmluOiB1c2Vyc0ZvbGxvd2VkIH1cclxuICAgICAgICAgICB9XHJcbiAgICAgICAgIH0sXHJcbiAgICAgICAgIHtcclxuICAgICAgICAgICAkc2FtcGxlOiB7IHNpemU6IDQgfVxyXG4gICAgICAgICB9LFxyXG4gICAgICAgICB7XHJcbiAgICAgICAgICAgJHByb2plY3Q6IHtcclxuICAgICAgICAgICAgIGlkOiB7ICR0b1N0cmluZzogXCIkX2lkXCIgfSxcclxuICAgICAgICAgICAgIG5hbWU6IDEsXHJcbiAgICAgICAgICAgICBpbWFnZTogMVxyXG4gICAgICAgICAgIH1cclxuICAgICAgICAgfVxyXG4gICAgICAgXSlcclxuICAgICAgfSlcclxuICAgICAgLnRoZW4odXNlcnMgPT4ge1xyXG4gICAgICAgIGlmKCF1c2VycykgdGhyb3cgbmV3IEVycm9yKCd1c2VycyBub3QgZm91bmQnKVxyXG5cclxuICAgICAgICB1c2Vycy5mb3JFYWNoKHVzZXIgPT4ge1xyXG4gICAgICAgICAgZGVsZXRlIHVzZXIuX2lkXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgcmV0dXJuIHVzZXJzXHJcbiAgICAgIH0pXHJcbn1cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gcmV0cmlldmVVc2Vyc05vdEZvbGxvd2VkIl0sIm1hcHBpbmdzIjoiczRGQWVZO0FBQUFBLGNBQUEsU0FBQUEsQ0FBQSxTQUFBQyxjQUFBLFdBQUFBLGNBQUEsRUFBQUQsY0FBQSxHQWZaLEtBQU0sQ0FBRUUsSUFBSyxDQUFDLEVBQUFGLGNBQUEsR0FBQUcsQ0FBQSxNQUFHQyxPQUFPLENBQUMsbUJBQW1CLENBQUMsRUFDN0MsS0FBTSxDQUFFQyxVQUFXLENBQUMsRUFBQUwsY0FBQSxHQUFBRyxDQUFBLE1BQUdDLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQyxFQUV2RCxRQUFTLENBQUFFLHdCQUF3QkEsQ0FBQ0MsTUFBTSxDQUFFLENBQUFQLGNBQUEsR0FBQVEsQ0FBQSxNQUFBUixjQUFBLEdBQUFHLENBQUEsTUFDdENFLFVBQVUsQ0FBQ0UsTUFBTSxDQUFDLENBQUFQLGNBQUEsR0FBQUcsQ0FBQSxNQUVsQixNQUFPLENBQUFELElBQUksQ0FBQ08sUUFBUSxDQUFDRixNQUFNLENBQUMsQ0FBQ0csSUFBSSxDQUFDLENBQUMsQ0FDbENDLElBQUksQ0FBQ0MsSUFBSSxFQUFJLENBQUFaLGNBQUEsR0FBQVEsQ0FBQSxNQUFBUixjQUFBLEdBQUFHLENBQUEsTUFDVixHQUFHLENBQUNTLElBQUksQ0FBRSxDQUFBWixjQUFBLEdBQUFhLENBQUEsU0FBQWIsY0FBQSxHQUFBRyxDQUFBLFdBQU0sSUFBSSxDQUFBVyxLQUFLLENBQUMsZ0JBQWdCLENBQUMsQ0FBRCxDQUFDLEtBQUFkLGNBQUEsR0FBQWEsQ0FBQSxVQUUzQyxLQUFNLENBQUFFLGFBQWEsRUFBQWYsY0FBQSxHQUFBRyxDQUFBLE1BQUdTLElBQUksQ0FBQ0ksU0FBUyxFQUFBaEIsY0FBQSxHQUFBYSxDQUFBLFNBQUdELElBQUksQ0FBQ0ksU0FBUyxHQUFBaEIsY0FBQSxHQUFBYSxDQUFBLFNBQUcsRUFBRSxHQUFBYixjQUFBLEdBQUFHLENBQUEsTUFDMURZLGFBQWEsQ0FBQ0UsSUFBSSxDQUFDTCxJQUFJLENBQUNNLEdBQUcsQ0FBQyxDQUFBbEIsY0FBQSxHQUFBRyxDQUFBLE1BRTVCLE1BQU8sQ0FBQUQsSUFBSSxDQUFDaUIsU0FBUyxDQUFDLENBQ3JCLENBQ0VDLE1BQU0sQ0FBRSxDQUNORixHQUFHLENBQUUsQ0FBRUcsSUFBSSxDQUFFTixhQUFjLENBQzdCLENBQ0YsQ0FBQyxDQUNELENBQ0VPLE9BQU8sQ0FBRSxDQUFFQyxJQUFJLENBQUUsQ0FBRSxDQUNyQixDQUFDLENBQ0QsQ0FDRUMsUUFBUSxDQUFFLENBQ1JDLEVBQUUsQ0FBRSxDQUFFQyxTQUFTLENBQUUsTUFBTyxDQUFDLENBQ3pCQyxJQUFJLENBQUUsQ0FBQyxDQUNQQyxLQUFLLENBQUUsQ0FDVCxDQUNGLENBQUMsQ0FDRixDQUFDLENBQ0gsQ0FBQyxDQUFDLENBQ0RqQixJQUFJLENBQUNrQixLQUFLLEVBQUksQ0FBQTdCLGNBQUEsR0FBQVEsQ0FBQSxNQUFBUixjQUFBLEdBQUFHLENBQUEsTUFDYixHQUFHLENBQUMwQixLQUFLLENBQUUsQ0FBQTdCLGNBQUEsR0FBQWEsQ0FBQSxTQUFBYixjQUFBLEdBQUFHLENBQUEsWUFBTSxJQUFJLENBQUFXLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxDQUFELENBQUMsS0FBQWQsY0FBQSxHQUFBYSxDQUFBLFVBQUFiLGNBQUEsR0FBQUcsQ0FBQSxPQUU3QzBCLEtBQUssQ0FBQ0MsT0FBTyxDQUFDbEIsSUFBSSxFQUFJLENBQUFaLGNBQUEsR0FBQVEsQ0FBQSxNQUFBUixjQUFBLEdBQUFHLENBQUEsT0FDcEIsTUFBTyxDQUFBUyxJQUFJLENBQUNNLEdBQUcsQ0FDakIsQ0FBQyxDQUFDLENBQUFsQixjQUFBLEdBQUFHLENBQUEsT0FFRixNQUFPLENBQUEwQixLQUFLLENBQ2QsQ0FBQyxDQUFDLENBQ1IsQ0FBQzdCLGNBQUEsR0FBQUcsQ0FBQSxPQUVENEIsTUFBTSxDQUFDQyxPQUFPLENBQUcxQix3QkFBd0IifQ==