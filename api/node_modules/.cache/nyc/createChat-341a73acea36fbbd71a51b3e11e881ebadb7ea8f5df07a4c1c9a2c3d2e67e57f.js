function cov_1dgjfqfy4m(){var path="C:\\Users\\loco8\\workspace\\eurofirms-bootcamp-202305\\staff\\manuel-david-castillo\\instaflan-fullstack\\api\\logic\\chats-logic\\createChat.js";var hash="ea3ff0057aa1c4d040f1ed0728febb71e62d74b1";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"C:\\Users\\loco8\\workspace\\eurofirms-bootcamp-202305\\staff\\manuel-david-castillo\\instaflan-fullstack\\api\\logic\\chats-logic\\createChat.js",statementMap:{"0":{start:{line:1,column:17},end:{line:1,column:45}},"1":{start:{line:2,column:23},end:{line:2,column:55}},"2":{start:{line:3,column:21},end:{line:3,column:39}},"3":{start:{line:6,column:4},end:{line:6,column:22}},"4":{start:{line:7,column:4},end:{line:7,column:22}},"5":{start:{line:9,column:18},end:{line:9,column:65}},"6":{start:{line:11,column:4},end:{line:28,column:6}},"7":{start:{line:14,column:12},end:{line:27,column:9}},"8":{start:{line:16,column:16},end:{line:16,column:30}},"9":{start:{line:18,column:29},end:{line:18,column:39}},"10":{start:{line:20,column:33},end:{line:20,column:35}},"11":{start:{line:22,column:16},end:{line:26,column:18}},"12":{start:{line:25,column:20},end:{line:25,column:34}},"13":{start:{line:31,column:0},end:{line:31,column:27}}},fnMap:{"0":{name:"createChat",decl:{start:{line:5,column:9},end:{line:5,column:19}},loc:{start:{line:5,column:39},end:{line:29,column:1}},line:5},"1":{name:"(anonymous_1)",decl:{start:{line:12,column:14},end:{line:12,column:15}},loc:{start:{line:12,column:22},end:{line:28,column:5}},line:12},"2":{name:"(anonymous_2)",decl:{start:{line:23,column:22},end:{line:23,column:23}},loc:{start:{line:23,column:30},end:{line:26,column:17}},line:23}},branchMap:{"0":{loc:{start:{line:14,column:12},end:{line:27,column:9}},type:"if",locations:[{start:{line:14,column:12},end:{line:27,column:9}},{start:{line:14,column:12},end:{line:27,column:9}}],line:14}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"ea3ff0057aa1c4d040f1ed0728febb71e62d74b1"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1dgjfqfy4m=function(){return actualCoverage;};}return actualCoverage;}cov_1dgjfqfy4m();const{Chat}=(cov_1dgjfqfy4m().s[0]++,require("../../data/models"));const{validateId}=(cov_1dgjfqfy4m().s[1]++,require("../helpers/validators"));const{ObjectId}=(cov_1dgjfqfy4m().s[2]++,require('mongodb'));function createChat(userId,otherUser){cov_1dgjfqfy4m().f[0]++;cov_1dgjfqfy4m().s[3]++;validateId(userId);cov_1dgjfqfy4m().s[4]++;validateId(userId);const users=(cov_1dgjfqfy4m().s[5]++,[new ObjectId(userId),new ObjectId(otherUser)]);cov_1dgjfqfy4m().s[6]++;return Chat.findOne({users:users},'-__v').then(chat=>{cov_1dgjfqfy4m().f[1]++;cov_1dgjfqfy4m().s[7]++;if(chat){cov_1dgjfqfy4m().b[0][0]++;cov_1dgjfqfy4m().s[8]++;return chat.id;}else{cov_1dgjfqfy4m().b[0][1]++;const date=(cov_1dgjfqfy4m().s[9]++,new Date());const messages=(cov_1dgjfqfy4m().s[10]++,[]);cov_1dgjfqfy4m().s[11]++;return Chat.create({users,messages,date}).then(chat=>{cov_1dgjfqfy4m().f[2]++;cov_1dgjfqfy4m().s[12]++;return chat.id;});}});}cov_1dgjfqfy4m().s[13]++;module.exports=createChat;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMWRnamZxZnk0bSIsImFjdHVhbENvdmVyYWdlIiwiQ2hhdCIsInMiLCJyZXF1aXJlIiwidmFsaWRhdGVJZCIsIk9iamVjdElkIiwiY3JlYXRlQ2hhdCIsInVzZXJJZCIsIm90aGVyVXNlciIsImYiLCJ1c2VycyIsImZpbmRPbmUiLCJ0aGVuIiwiY2hhdCIsImIiLCJpZCIsImRhdGUiLCJEYXRlIiwibWVzc2FnZXMiLCJjcmVhdGUiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiY3JlYXRlQ2hhdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCB7IENoYXQgfSA9IHJlcXVpcmUoXCIuLi8uLi9kYXRhL21vZGVsc1wiKTtcclxuY29uc3QgeyB2YWxpZGF0ZUlkIH0gPSByZXF1aXJlKFwiLi4vaGVscGVycy92YWxpZGF0b3JzXCIpO1xyXG5jb25zdCB7IE9iamVjdElkIH0gPSByZXF1aXJlKCdtb25nb2RiJylcclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUNoYXQodXNlcklkLCBvdGhlclVzZXIpIHtcclxuICAgIHZhbGlkYXRlSWQodXNlcklkKVxyXG4gICAgdmFsaWRhdGVJZCh1c2VySWQpXHJcblxyXG4gICAgY29uc3QgdXNlcnMgPSBbbmV3IE9iamVjdElkKHVzZXJJZCksIG5ldyBPYmplY3RJZChvdGhlclVzZXIpXVxyXG5cclxuICAgIHJldHVybiBDaGF0LmZpbmRPbmUoe3VzZXJzOiB1c2Vyc30sICctX192JylcclxuICAgICAgICAudGhlbihjaGF0ID0+IHtcclxuXHJcbiAgICAgICAgICAgIGlmKGNoYXQpIHtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gY2hhdC5pZFxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKClcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlcyA9IFtdXHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIENoYXQuY3JlYXRlKHt1c2VycywgbWVzc2FnZXMsIGRhdGV9KVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oY2hhdCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNoYXQuaWRcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxufVxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBjcmVhdGVDaGF0Il0sIm1hcHBpbmdzIjoicXZFQWVZO0FBQUFBLGNBQUEsU0FBQUEsQ0FBQSxTQUFBQyxjQUFBLFdBQUFBLGNBQUEsRUFBQUQsY0FBQSxHQWZaLEtBQU0sQ0FBRUUsSUFBSyxDQUFDLEVBQUFGLGNBQUEsR0FBQUcsQ0FBQSxNQUFHQyxPQUFPLENBQUMsbUJBQW1CLENBQUMsRUFDN0MsS0FBTSxDQUFFQyxVQUFXLENBQUMsRUFBQUwsY0FBQSxHQUFBRyxDQUFBLE1BQUdDLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQyxFQUN2RCxLQUFNLENBQUVFLFFBQVMsQ0FBQyxFQUFBTixjQUFBLEdBQUFHLENBQUEsTUFBR0MsT0FBTyxDQUFDLFNBQVMsQ0FBQyxFQUV2QyxRQUFTLENBQUFHLFVBQVVBLENBQUNDLE1BQU0sQ0FBRUMsU0FBUyxDQUFFLENBQUFULGNBQUEsR0FBQVUsQ0FBQSxNQUFBVixjQUFBLEdBQUFHLENBQUEsTUFDbkNFLFVBQVUsQ0FBQ0csTUFBTSxDQUFDLENBQUFSLGNBQUEsR0FBQUcsQ0FBQSxNQUNsQkUsVUFBVSxDQUFDRyxNQUFNLENBQUMsQ0FFbEIsS0FBTSxDQUFBRyxLQUFLLEVBQUFYLGNBQUEsR0FBQUcsQ0FBQSxNQUFHLENBQUMsR0FBSSxDQUFBRyxRQUFRLENBQUNFLE1BQU0sQ0FBQyxDQUFFLEdBQUksQ0FBQUYsUUFBUSxDQUFDRyxTQUFTLENBQUMsQ0FBQyxFQUFBVCxjQUFBLEdBQUFHLENBQUEsTUFFN0QsTUFBTyxDQUFBRCxJQUFJLENBQUNVLE9BQU8sQ0FBQyxDQUFDRCxLQUFLLENBQUVBLEtBQUssQ0FBQyxDQUFFLE1BQU0sQ0FBQyxDQUN0Q0UsSUFBSSxDQUFDQyxJQUFJLEVBQUksQ0FBQWQsY0FBQSxHQUFBVSxDQUFBLE1BQUFWLGNBQUEsR0FBQUcsQ0FBQSxNQUVWLEdBQUdXLElBQUksQ0FBRSxDQUFBZCxjQUFBLEdBQUFlLENBQUEsU0FBQWYsY0FBQSxHQUFBRyxDQUFBLE1BRUwsTUFBTyxDQUFBVyxJQUFJLENBQUNFLEVBQUUsQ0FDbEIsQ0FBQyxJQUFNLENBQUFoQixjQUFBLEdBQUFlLENBQUEsU0FDSCxLQUFNLENBQUFFLElBQUksRUFBQWpCLGNBQUEsR0FBQUcsQ0FBQSxNQUFHLEdBQUksQ0FBQWUsSUFBSSxDQUFDLENBQUMsRUFFdkIsS0FBTSxDQUFBQyxRQUFRLEVBQUFuQixjQUFBLEdBQUFHLENBQUEsT0FBRyxFQUFFLEVBQUFILGNBQUEsR0FBQUcsQ0FBQSxPQUVuQixNQUFPLENBQUFELElBQUksQ0FBQ2tCLE1BQU0sQ0FBQyxDQUFDVCxLQUFLLENBQUVRLFFBQVEsQ0FBRUYsSUFBSSxDQUFDLENBQUMsQ0FDMUNKLElBQUksQ0FBQ0MsSUFBSSxFQUFJLENBQUFkLGNBQUEsR0FBQVUsQ0FBQSxNQUFBVixjQUFBLEdBQUFHLENBQUEsT0FFVixNQUFPLENBQUFXLElBQUksQ0FBQ0UsRUFBRSxDQUNsQixDQUFDLENBQUMsQ0FDVixDQUNKLENBQUMsQ0FBQyxDQUNOLENBQUNoQixjQUFBLEdBQUFHLENBQUEsT0FFRGtCLE1BQU0sQ0FBQ0MsT0FBTyxDQUFHZixVQUFVIn0=